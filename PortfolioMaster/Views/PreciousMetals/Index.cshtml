@model PortfolioMaster.Models.PreciousMetalsViewModel
@{
    ViewData["Title"] = "Precious Metals";
    var editButtonStyle = "btn btn-sm btn-primary";
    var deleteButtonStyle = "btn btn-sm btn-danger";
}

<h1>@ViewData["Title"]</h1>

<div class="container">
    <table class="table">
        <thead>
            <tr>
                <th>Metal</th>
                <th>Total Quantity</th>
                <th>Total Purchase Price</th>
                <th>Current Price</th>
                <th>Total Value</th>
                <th>P/L</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var goldHolding in Model.GoldHoldings)
            {
                <tr>
                    <td>@goldHolding.Name</td>
                    <td>@goldHolding.AssetHoldings.Sum(h => h.Quantity)</td>
                    <td>@goldHolding.AssetHoldings.Sum(h => h.PurchasePrice * h.Quantity)</td>
                    <td>@ViewBag.GoldPrice</td>
                    <td>@(goldHolding.AssetHoldings.Sum(h => h.Quantity) * ViewBag.GoldPrice)</td>
                    <td>@((goldHolding.AssetHoldings.Sum(h => h.Quantity) * ViewBag.GoldPrice) - goldHolding.AssetHoldings.Sum(h => h.PurchasePrice * h.Quantity))</td>
                </tr>
                <tr>
                    <td colspan="6">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Purchase Date</th>
                                    <th>Quantity</th>
                                    <th>Purchase Price</th>
                                    <th>Value</th>
                                    <th>P/L</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var asset in goldHolding.AssetHoldings)
                                {
                                    <tr>
                                        <td>@asset.PurchaseDate</td>
                                        <td>@asset.Quantity</td>
                                        <td>@(asset.PurchasePrice * asset.Quantity)</td>
                                        <td>@(asset.Quantity * ViewBag.GoldPrice)</td>
                                        <td>@((asset.Quantity * ViewBag.GoldPrice) - (asset.PurchasePrice * asset.Quantity))</td>
                                        <td>
                                            <a asp-controller="PreciousMetals" asp-action="Edit" asp-route-id="@asset.Id" class="@editButtonStyle">Edit</a>
                                            <a asp-controller="PreciousMetals" asp-action="Delete" asp-route-id="@asset.Id" class="@deleteButtonStyle">Delete</a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </td>
                </tr>
            }
        </tbody>
    </table>
    <table class="table">
        <thead>
            <tr>
                <th>Metal</th>
                <th>Total Quantity</th>
                <th>Total Purchase Price</th>
                <th>Current Price</th>
                <th>Total Value</th>
                <th>P/L</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var silverHolding in Model.SilverHoldings)
            {
                <tr>
                    <td>@silverHolding.Name</td>
                    <td>@silverHolding.AssetHoldings.Sum(h => h.Quantity)</td>
                    <td>@silverHolding.AssetHoldings.Sum(h => h.PurchasePrice * h.Quantity)</td>
                    <td>@ViewBag.SilverPrice</td>
                    <td>@(silverHolding.AssetHoldings.Sum(h => h.Quantity) * ViewBag.SilverPrice)</td>
                    <td>@((silverHolding.AssetHoldings.Sum(h => h.Quantity) * ViewBag.SilverPrice) - silverHolding.AssetHoldings.Sum(h => h.PurchasePrice * h.Quantity))</td>
                </tr>
                <tr>
                    <td colspan="6">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Purchase Date</th>
                                    <th>Quantity</th>
                                    <th>Purchase Price</th>
                                    <th>Value</th>
                                    <th>P/L</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var asset in silverHolding.AssetHoldings)
                                {
                                    <tr>
                                        <td>@asset.PurchaseDate</td>
                                        <td>@asset.Quantity</td>
                                        <td>@(asset.PurchasePrice * asset.Quantity)</td>
                                        <td>@(asset.Quantity * ViewBag.SilverPrice)</td>
                                        <td>@((asset.Quantity * ViewBag.SilverPrice) - (asset.PurchasePrice * asset.Quantity))</td>
                                        <td>
                                            <a asp-controller="PreciousMetals" asp-action="Edit" asp-route-id="@asset.Id" class="@editButtonStyle">Edit</a>
                                            <a asp-controller="PreciousMetals" asp-action="Delete" asp-route-id="@asset.Id" class="@deleteButtonStyle">Delete</a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </td>
                </tr>
            }
        </tbody>
    </table>
    <!-- Add the footnote with gold and silver prices -->
    <div>
        <p>
            <strong>Gold Price:</strong> @ViewBag.GoldPrice USD per ounce
        </p>
        <p>
            <strong>Silver Price:</strong> @ViewBag.SilverPrice USD per ounce
        </p>
    </div>
</div>
